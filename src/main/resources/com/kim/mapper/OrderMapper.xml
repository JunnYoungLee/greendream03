<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.kim.mapper.OrderMapper">
	 
	 <select id="list" resultType="com.kim.model.OrderDTO">
	 	select * from stock;
	 </select>
	 
	 <select id="medical_department_list" resultType="com.kim.model.OrderDTO">
	 	select * from stock
	 	where dept = '내과';
	 </select>
	 
	 <update id="current_quantity_update">
	 	update stock
	 	set current_quantity = #{current_quantity}
	 	where dept = #{dept} and medical_supply_code = #{medical_supply_code}
	 </update>
	 
	 <insert id="consumption_check">
	 	insert into consumption_check 
	 	values(#{dept}, #{medical_supply_code}, #{medical_supplies_name}, 
	 	#{standard}, #{unit}, #{used_quantity}, #{current_quantity}, 
	 	#{date}, #{person_in_charge});
	 </insert>
	 
	 <insert id="request_check">
	 	insert into request_check 
	 	values(#{dept}, #{medical_supply_code}, #{medical_supplies_name}, 
	 	#{standard}, #{unit}, #{supplier}, #{unit_price}, #{current_quantity}, 
	 	#{safety_inventory_quantuty}, #{request_quantity}, #{person_in_charge}, 
	 	#{date}, #{special_note}, #{progress_status}, 'null');
	 </insert>
	 
	 <select id="request_list" resultType="com.kim.model.OrderDTO">
	 	select *, 
	 	unit_price*request_quantity as supply_price,
	 	unit_price*request_quantity*0.1 as surtax,
	 	unit_price*request_quantity + unit_price*request_quantity*0.1 as total_price
	 	from request_check
	 	where dept = '내과' ;
	 </select>
</mapper>